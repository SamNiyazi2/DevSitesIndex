@page
@model DevSitesIndex.Pages.TimeLogs.IndexModel

@{
    ViewData["Title"] = "Timesheet Index";
}

@section styles {

}
<h2>@ViewData["Title"]</h2>

<p>
    <a asp-page="Create">Create New</a>
</p>
<div ng-app="timesheetApp">

    <div ng-controller="timesheetController">

        <table class="table">
            <thead>
                <tr>
                    @*// 08/28/2019 04:28 am - SSN - [20190828-0427] - [001] - Apply sorting and paging to timelogs index*@
                    @{await Html.RenderPartialAsync("HeaderWithSortLinks", Model.pageUtil.headerWithSortLinks);}
                    <th></th>
                </tr>

            </thead>
            <tbody>
                @foreach (var item in Model.TimeLog)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.StartTime)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.TotalSeconds_ToTimeSpanFormat_T)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.job.JobTitle)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.discipline.DisciplineShort)
                        </td>



                        <td class="indexNowrapCol">
                            @Html.DisplayFor(modelItem => item.DateAdded)
                        </td>

                        <td class="indexNowrapCol">
                            @Html.DisplayFor(modelItem => item.DateModified)
                        </td>

                        <td class="indexNowrapCol">

                            <a asp-page="./Edit" asp-route-id="@item.TimeLogId">Edit</a>


                            <strong>

                                ||
                                <a asp-page="./Details" asp-route-id="@item.TimeLogId">Entry's Details</a>
                                |
                                <a asp-page="/jobs/details" asp-route-id="@item.JobId">Job's Details</a>
                                |
                                <a asp-page="/projects/details" asp-route-id="@item.job.ProjectID">Project's Details</a>
                                ||
                            </strong>

                            <a asp-page="./Delete" asp-route-id="@item.TimeLogId">Delete</a> |

                            <a ng-If="'@item.TotalSeconds' <= 0 " ng-click="timesheetForm_ClockOut(@item.TimeLogId)" class="alert-warning">Clock-out</a>


                            <!-- 05/19/2019 08:38 am - SSN - [20190519-0837] - [001] - Adding timesheet "Continue" option -->
                            <!-- 09/24/2019 04:16 am - SSN - [20190924-0401] - [002] - Quick timelog entry -->
                            <!-- Allow to resue link for a quick entry-->
                            |
                            @{
                                string caption = (item.TotalSeconds ?? 0) > 0 ? "Continue" : "Line Item";

                            }
                            <a ng-click="timesheetForm_ClockContinue(@item.TimeLogId)" class="alert-warning">@caption</a>


                        </td>
                    </tr>

                    @if (!string.IsNullOrWhiteSpace(item.WorkDetail))
                    {

                        <tr class="detail">
                            <td colspan="2"></td>
                            @*06/01/2019 02:59 pm - SSN - Added class codeblock2*@
                            <td colspan="5" class="codeblock2">
                                @Html.DisplayFor(modelItem => item.WorkDetail)
                            </td>

                        </tr>
                    }
                }
            </tbody>
        </table>


        @*// 08/28/2019 04:28 am - SSN - [20190828-0427] - [001] - Apply sorting and paging to timelogs index*@
        @{await Html.RenderPartialAsync("TablePager", Model.pageUtil.tablePager);}

    </div>
</div>


@section Scripts {
    @{await Html.RenderPartialAsync("TimesheetAngularScripts");}
}
